-- =====================================================
-- üìò BASE DE DATOS: JARDINER√çA
-- =====================================================


-- üü¢ NIVEL 1 ‚Äì MUY B√ÅSICO (SELECT)

-- 1. Mostrar todos los clientes.
select * from clientes;
-- 2. Mostrar todos los productos.
select * from productos;
-- 3. Mostrar solo el nombre y el precio de los productos.
select nombre , precioventa from productos;
-- 4. Mostrar todas las categor√≠as existentes.
select gama from productos;
-- 5. Mostrar los clientes que viven en Madrid.
select nombrecliente, ciudad from clientes where ciudad = "madrid";
-- 6. Mostrar los productos con precio mayor a 20.
select * from productos where precioventa > 20;
-- 7. Mostrar los productos con stock menor a 50.
select nombre,CantidadEnStock from productos where CantidadEnStock  < 50 ;
-- 8. Mostrar los pedidos con estado ‚Äúpagado‚Äù.
select * from pedidos where Estado = "pagado";
-- 9. Mostrar los clientes ordenados por nombre.
select *  from clientes
order by NombreCliente asc;
-- 10. Mostrar los productos ordenados por precio de mayor a menor.
select * from productos
order by PrecioVenta asc;


-- üü¢ NIVEL 2 ‚Äì FILTROS (WHERE, AND, OR, BETWEEN, LIKE)

-- 11. Mostrar los clientes registrados despu√©s del 1 de febrero de 2025.
-- 12. Mostrar los productos con precio entre 15 y 30.
-- 13. Mostrar los productos de la categor√≠a Tecnolog√≠a.
-- 14. Mostrar los clientes que viven en Madrid o Barcelona.
-- 15. Mostrar los productos cuyo nombre empiece por la letra ‚ÄúC‚Äù.
-- 16. Mostrar los pedidos que no est√©n cancelados.
-- 17. Mostrar los productos con stock entre 30 y 80.
-- 18. Mostrar los clientes cuyo email contenga ‚Äú@email.com‚Äù.
-- 19. Mostrar los pedidos realizados durante abril de 2025.
-- 20. Mostrar los productos que no cuestan 25.


-- üü° NIVEL 3 ‚Äì FUNCIONES Y AGREGACI√ìN

-- 21. Mostrar el precio m√°ximo de los productos.
-- 22. Mostrar el precio m√≠nimo de los productos.
-- 23. Mostrar el precio promedio de los productos.
-- 24. Contar cu√°ntos clientes hay por ciudad.
-- 25. Contar cu√°ntos productos hay por categor√≠a.
-- 26. Mostrar el total de pedidos realizados.
-- 27. Mostrar cu√°ntos pedidos hay por estado.
-- 28. Mostrar el stock total de todos los productos.
-- 29. Mostrar el precio promedio de los productos de la categor√≠a Tecnolog√≠a.
-- 30. Mostrar las ciudades que tienen m√°s de un cliente.


-- üü° NIVEL 4 ‚Äì JOINS (MUY IMPORTANTE)

-- 31. Mostrar cada producto junto con su categor√≠a.
-- 32. Mostrar los pedidos junto con el nombre del cliente.
-- 33. Mostrar el detalle de los pedidos (producto, cantidad y precio).
-- 34. Mostrar los pedidos junto con el cliente y su estado.
-- 35. Mostrar los productos vendidos en cada pedido.
-- 36. Mostrar los clientes que han realizado pedidos.
-- 37. Mostrar los clientes que no han realizado ning√∫n pedido.
-- 38. Mostrar los pedidos que contienen productos de la categor√≠a Ropa.
-- 39. Mostrar el nombre del cliente y la fecha de cada uno de sus pedidos.
-- 40. Mostrar los productos junto con la cantidad total vendida.


-- üü† NIVEL 5 ‚Äì C√ÅLCULOS Y GROUP BY

-- 41. Calcular el importe total de cada pedido.
-- 42. Calcular el total de dinero gastado por cada cliente.
-- 43. Mostrar los clientes que han gastado m√°s de 50.
-- 44. Mostrar el producto m√°s vendido.
-- 45. Mostrar los tres productos m√°s vendidos.
-- 46. Mostrar el ingreso total de la tienda.
-- 47. Mostrar el ingreso total por categor√≠a.
-- 48. Mostrar cu√°ntos productos se han vendido por categor√≠a.
-- 49. Mostrar el pedido con el importe m√°s alto.
-- 50. Mostrar los clientes ordenados por el dinero total gastado.


-- üî¥ NIVEL 6 ‚Äì SUBCONSULTAS (DESAF√çO)

-- 51. Mostrar los productos cuyo precio sea mayor que el precio promedio.
-- 52. Mostrar los clientes que han realizado m√°s pedidos que el promedio.
-- 53. Mostrar los productos que nunca se han vendido.
-- 54. Mostrar los clientes que no tienen pedidos cancelados.
-- 55. Mostrar el pedido que tiene m√°s productos distintos.
-- 56. Mostrar el cliente que m√°s ha gastado.
-- 57. Mostrar la categor√≠a con mayores ingresos.
-- 58. Mostrar los productos vendidos en pedidos pagados.
-- 59. Mostrar los clientes que han comprado Auriculares.
-- 60. Mostrar los pedidos cuyo importe total sea mayor que el promedio.

-- GROUP BY
-- 1) Por cada cliente (CodigoCliente): n√∫mero de pedidos que ha hecho, fecha del su primer
-- pedido y fecha del √∫ltimo.

-- 2) Por cada gama: precio m√°ximo, m√≠nimo y medio de sus productos

-- 3) Importe total de cada pedido

-- 4) Nombre completo del empleado en una sola columna y n√∫mero de clientes que tiene a
-- su cargo

-- 5) Nombre y direcci√≥n de cada oficina y n√∫mero de empleados que tienen de las oficinas
-- que no sean de Espa√±a o Spain.

-- 6) Importe total de los pagos efectuados por cada cliente en cada a√±o.

-- 7) Nombre del jefe y n√∫mero de empleados que tiene a su cargo

				-- HAVING

-- 8) N√∫mero de pedidos que ha hecho cada cliente viendo el nombre y la direcci√≥n del
-- cliente, de los clientes que han hecho m√°s de 3 pedidos.
select * from pedidos;

select codigocliente, count(*)
from pedidos
group by  CodigoCliente
having count(*) > 5 ;

-- 9) N√∫mero de pedidos que ha hecho cada cliente viendo el nombre y la direcci√≥n del
-- cliente, de los clientes que han hecho pedidos por un importe mayor que 1000‚Ç¨.
select * from pedidos;

SELECT p.CodigoCliente, COUNT(DISTINCT p.CodigoPedido) AS NumeroPedidos
FROM pedidos p
JOIN detallepedidos d ON p.CodigoPedido = d.CodigoPedido
GROUP BY p.CodigoCliente
HAVING SUM(d.Cantidad * d.PrecioUnidad) > 1000;

-- 10) Por cada gama, precio m√°ximo, m√≠nimo y medio de sus productos. De las categor√≠as
-- con menos de 10 productos

-- 11) Fecha del primer pedido de cada cliente que haya hecho alg√∫n pedido en el 2018 o
-- despu√©s.

-- 12) Nombre completo del empleado y n√∫mero de clientes que tiene a su cargo de los
-- empleados que trabajen en oficinas de Madrid o Barcelona y tengan al menos tres
-- clientes.

-- 13) Nombre y direcci√≥n de cada oficina y n√∫mero de empleados que tiene de las oficinas
-- que no sean de Espa√±a o Spain y tengan menos de 10 empleados

-- 14) Importe total de los pagos efectuados por cada cliente en cada a√±o a partir del a√±o
-- 2017